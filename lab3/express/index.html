<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agenda</title>
</head>
<body>
    <form id="form" action="./eventos" method="post" target="_null">
        <input type="text" name="title"><br>
        <input type="text" name="fecha" value="AAAA-MM-DD"><br>
        <input type="text" name="hora" value="HH-MM"><br>
        <textarea name="desc" cols="30" rows="10"></textarea><br>
        <input type="submit" value="OK">
    </form>
    
        <input type="submit" value="Ver eventos" onclick="mostrar()">
    
    <div id="prueba"></div>
    <script>
        function mostrar() {
          const url = 'http://localhost:3000/eventos';
          fetch(url, { mode: 'cors' })
            .then(response => response.json())
            .then(data => {
              const agenda = data;
              let html = '';
      
              agenda.forEach(item => {
                html += `<h3>${item.date}</h3>`;
                html += '<ul>';
                item.events.forEach(event => {
                  html += `<li>${event.time} `;
                  html += `<input type="hidden" id="date" value="${item.date}">
                    <input type="hidden" id="time" value="${event.time}">
                    <input type="submit" value="eliminar" onclick="borrar()">`
                });
                html += '</ul>';
              });
      
              document.querySelector("#prueba").innerHTML = html;
            });
            //document.querySelector("#prueba").innerHTML = "html";
        }
        function borrar(){
            const date = document.getElementById("date");
            const time = document.getElementById("time");
            const url = `http://localhost:3000/eventos/${date}/${time}`;
            fetch(url, {
                method: "DELETE"
                })
                .then(response => {
                    if (response.ok) {
                    console.log("Evento eliminado exitosamente");
                    // Hacer algo despuÃ©s de eliminar el evento
                    } else {
                    console.error("Error al eliminar el evento");
                    }
                })
                .catch(error => {
                    console.error(error);
                });
        }
    </script>
</body>
</html>
